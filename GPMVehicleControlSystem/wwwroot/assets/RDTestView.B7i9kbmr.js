var E=Object.defineProperty;var U=(a,t,m)=>t in a?E(a,t,{enumerable:!0,configurable:!0,writable:!0,value:m}):a[t]=m;var p=(a,t,m)=>U(a,typeof t!="symbol"?t+"":t,m);import{u as f,_ as D,x as F,c as A,o as O,b as e,w as o,y as B,a as i,z as I,B as M,C as G,G as P,H as z,J as H,d as u,t as d,r as v,L as W,N as j,O as J,R as k,j as y}from"./index.BjD4cEKf.js";class K{constructor(){p(this,"loopNum",100);p(this,"up_limit_pose",120);p(this,"down_limit_pose",0);p(this,"speed",1);p(this,"useRandomPose",!0);p(this,"initalizeBeforeTest",!1);p(this,"pauseWhenReachQuarter",!0)}}let T={async Start(a){console.warn(a);var t=await f.post("/api/RDTEST/fork_test/start",a);return t.data},async Abort(){var a=await f.post("/api/RDTEST/fork_test/abort");return a.data},async Continue(){var a=await f.post("/api/RDTEST/fork_test/continue");return a.data}},g={async Start(a){console.warn(a);var t=await f.post("/api/RDTEST/MoveTest",a);return t.data},async Stop(){var a=await f.post("/api/RDTEST/MoveTest/Stop");return a.data}};const L={components:{ForkAGV3D:F},data(){return{current_pose:-1,option:new K,ack_response:{Success:!0,Message:""},selected_tab:"move_test",move_test_options:{theta_move:90,duration:60,delay_time:1,rotation_speed:.3},timer:void 0}},methods:{async ForkTestStart(){this.ack_response=await T.Start(this.option),localStorage.setItem("fork-test-options",JSON.stringify(this.option))},async ForkTestAbort(){this.ack_response=await T.Abort()},async ContiunTestWhenPause(){this.ack_response=await T.Continue()},async HandleMoveTestStart(){var a=await g.Start(this.move_test_options);a.result?(this.rotation_test_period=0,this.timer=setInterval(()=>{this.rotation_test_period+=1},1e3)):this.$swal.fire({text:"",title:a.message,icon:"error",showCancelButton:!1,confirmButtonText:"OK",customClass:"my-sweetalert"})},HandleMoveTestStop(){g.Stop(),clearInterval(this.timer)}},computed:{forkTestState(){return k.getters.testData},abort_btn_disabled(){return this.forkTestState.state!="RUNNING"},start_btn_disabled(){return this.forkTestState.state=="RUNNING"},show_reject_modal(){return this.ack_response.Success==!1},show_test_paused_model(){return this.forkTestState.state=="PAUSE"},current_theta(){return y.getters.CurrentAngle},current_tag(){return y.getters.CurrentTag},rotation_test_period(){return k.getters.testData.move_test.duration},rotation_test_state(){return k.getters.testData.move_test.state}},mounted(){J.on("/z_axis_position",t=>{this.current_pose=t});var a=localStorage.getItem("fork-test-options");a&&(this.option=JSON.parse(a))}},Q={class:"p-1 bg-light text-dark"},q={class:"border rounded p-3 text-start w-100"},X=i("h3",null,"FORK 測試",-1),Y={class:"d-flex flex-row"},Z={class:"my-1"},$={class:"my-1"},ee={class:"px-3"},te={class:"text-center px-5"},oe={class:"text-center px-5"},le={class:"text-center px-5"},se=i("span",{class:"mx-3"},"秒",-1),ae={class:"text-start"};function ne(a,t,m,re,l,n){const C=I,_=P,r=G,b=z,c=H,V=v("b-button"),S=M,N=v("ForkAGV3D"),w=v("b-modal"),x=B,h=W,R=j;return O(),A("div",Q,[e(R,{modelValue:l.selected_tab,"onUpdate:modelValue":t[13]||(t[13]=s=>l.selected_tab=s)},{default:o(()=>[e(x,{name:"fork_test",label:"Fork Test"},{default:o(()=>[i("div",q,[X,e(C),i("div",Y,[e(S,{"label-width":"160px","label-position":"left"},{default:o(()=>[e(r,{label:"測試LOOP"},{default:o(()=>[e(_,{modelValue:l.option.loopNum,"onUpdate:modelValue":t[0]||(t[0]=s=>l.option.loopNum=s),min:"1",max:"1000"},null,8,["modelValue"])]),_:1}),e(r,{label:"上點位位置"},{default:o(()=>[e(_,{modelValue:l.option.up_limit_pose,"onUpdate:modelValue":t[1]||(t[1]=s=>l.option.up_limit_pose=s),min:"0",max:"176.0",step:"0.1"},null,8,["modelValue"])]),_:1}),e(r,{label:"下點位位置"},{default:o(()=>[e(_,{modelValue:l.option.down_limit_pose,"onUpdate:modelValue":t[2]||(t[2]=s=>l.option.down_limit_pose=s),min:"0",max:"170.0",step:"0.1"},null,8,["modelValue"])]),_:1}),e(r,{label:"速度"},{default:o(()=>[e(_,{modelValue:l.option.speed,"onUpdate:modelValue":t[3]||(t[3]=s=>l.option.speed=s),min:"0.1",max:"1.0",step:"0.1"},null,8,["modelValue"])]),_:1}),e(r,{label:"測試前初始化"},{default:o(()=>[e(b,{modelValue:l.option.initalizeBeforeTest,"onUpdate:modelValue":t[4]||(t[4]=s=>l.option.initalizeBeforeTest=s),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),e(r,{label:"使用Random位置"},{default:o(()=>[e(b,{modelValue:l.option.useRandomPose,"onUpdate:modelValue":t[5]||(t[5]=s=>l.option.useRandomPose=s),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),e(r,{label:"次數達四分位數暫停"},{default:o(()=>[e(b,{modelValue:l.option.pauseWhenReachQuarter,"onUpdate:modelValue":t[6]||(t[6]=s=>l.option.pauseWhenReachQuarter=s),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),e(r,{label:"Current Position"},{default:o(()=>[e(c,{style:{width:"100px"},effect:"dark",type:"info"},{default:o(()=>[u(d(l.current_pose),1)]),_:1})]),_:1}),e(r,{label:"測試狀態"},{default:o(()=>[e(c,{style:{width:"100px"},effect:"dark"},{default:o(()=>[u(d(n.forkTestState.state),1)]),_:1})]),_:1}),e(r,{label:"Fork動作"},{default:o(()=>[e(c,{style:{width:"100px"},effect:"dark"},{default:o(()=>[u(d(n.forkTestState.fork_action),1)]),_:1})]),_:1}),e(r,{label:"已完成次數"},{default:o(()=>[e(c,{style:{width:"100px"},effect:"dark",type:"info"},{default:o(()=>[u(d(n.forkTestState.complete_loop_num)+"/"+d(l.option.loopNum),1)]),_:1})]),_:1}),i("div",Z,[e(V,{disabled:n.start_btn_disabled,class:"w-100",variant:"primary",onClick:n.ForkTestStart},{default:o(()=>[u("Start")]),_:1},8,["disabled","onClick"])]),i("div",$,[e(V,{disabled:n.abort_btn_disabled,class:"w-100",variant:"danger",onClick:n.ForkTestAbort},{default:o(()=>[u("中斷")]),_:1},8,["disabled","onClick"])])]),_:1}),e(N,{class:"mx-5"})]),e(w,{modelValue:n.show_reject_modal,"onUpdate:modelValue":t[7]||(t[7]=s=>n.show_reject_modal=s),centered:!0,"ok-only":!0},{default:o(()=>[i("p",null,d(l.ack_response.Message),1)]),_:1},8,["modelValue"]),e(w,{modelValue:n.show_test_paused_model,"onUpdate:modelValue":t[8]||(t[8]=s=>n.show_test_paused_model=s),centered:!0,title:"測試已達四分位數","cancel-title":"中斷","ok-title":"繼續","no-close-on-backdrop":!0,"no-close-on-esc":!0,"cancel-variant":"danger",onOk:n.ContiunTestWhenPause,onCancel:n.ForkTestAbort},{default:o(()=>[i("p",null,d(`測試暫停中，已達${n.forkTestState.complete_loop_num}`),1)]),_:1},8,["modelValue","onOk","onCancel"])])]),_:1}),e(x,{name:"move_test",label:"Move Test"},{default:o(()=>[i("div",ee,[e(S,{"label-width":"110","label-position":"left"},{default:o(()=>[e(r,{label:"狀態"},{default:o(()=>[e(c,{effect:"dark",class:"text-center px-5",type:n.rotation_test_state==1?"warning":"success"},{default:o(()=>[u(d(n.rotation_test_state==1?"IDLE":"RUNNING"),1)]),_:1},8,["type"])]),_:1}),e(r,{label:"角度"},{default:o(()=>[e(_,{modelValue:l.move_test_options.theta_move,"onUpdate:modelValue":t[9]||(t[9]=s=>l.move_test_options.theta_move=s)},null,8,["modelValue"])]),_:1}),e(r,{label:"當前角度"},{default:o(()=>[i("div",te,d(n.current_theta),1)]),_:1}),e(r,{label:"當前TAG"},{default:o(()=>[i("div",oe,d(n.current_tag),1)]),_:1}),e(r,{label:"持續時間(秒)"},{default:o(()=>[e(_,{modelValue:l.move_test_options.duration,"onUpdate:modelValue":t[10]||(t[10]=s=>l.move_test_options.duration=s)},null,8,["modelValue"])]),_:1}),e(r,{label:"停滯時間(秒)"},{default:o(()=>[e(_,{modelValue:l.move_test_options.delay_time,"onUpdate:modelValue":t[11]||(t[11]=s=>l.move_test_options.delay_time=s)},null,8,["modelValue"])]),_:1}),e(r,{label:"旋轉速度"},{default:o(()=>[e(_,{step:.1,modelValue:l.move_test_options.rotation_speed,"onUpdate:modelValue":t[12]||(t[12]=s=>l.move_test_options.rotation_speed=s)},null,8,["modelValue"])]),_:1}),e(r,{label:"歷時"},{default:o(()=>[i("div",le,[u(d(n.rotation_test_period)+" ",1),se])]),_:1})]),_:1}),i("div",ae,[e(h,{onClick:n.HandleMoveTestStart,style:{width:"125px"},type:"primary"},{default:o(()=>[u("Start")]),_:1},8,["onClick"]),e(h,{onClick:n.HandleMoveTestStop,style:{width:"125px"},type:"danger"},{default:o(()=>[u("Stop")]),_:1},8,["onClick"])])])]),_:1})]),_:1},8,["modelValue"])])}const ue=D(L,[["render",ne]]);export{ue as default};
